import { flexCalcTree, FlexError } from '../src';

test('Should not calc tree from 0 leaves', () => {
  expect(() => {
    flexCalcTree({
      leaves: [],
    });
  }).toThrow(FlexError);
});

test('Should calc tree from 1 leaf', () => {
  const tree = flexCalcTree({
    leaves: ['0x1111111111111111111111111111111111111111111111111111111111111111'],
  });
  expect(tree).toEqual({
    root: '0x1111111111111111111111111111111111111111111111111111111111111111',
    parents: {},
    siblings: {},
  });
});

test('Should calc tree from 2 leaves', () => {
  const tree = flexCalcTree({
    leaves: [
      '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x2222222222222222222222222222222222222222222222222222222222222222',
    ],
  });
  expect(tree).toEqual({
    root: '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
    parents: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
    },
    siblings: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x1111111111111111111111111111111111111111111111111111111111111111',
    },
  });
});

test('Should not calc tree from 2 leaves with duplicate', () => {
  expect(() => {
    flexCalcTree({
      leaves: [
        '0x1111111111111111111111111111111111111111111111111111111111111111',
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      ],
    });
  }).toThrow(FlexError);
});

test('Should calc tree from 3 leaves', () => {
  const tree = flexCalcTree({
    leaves: [
      '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x3333333333333333333333333333333333333333333333333333333333333333',
    ],
  });
  expect(tree).toEqual({
    root: '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
    parents: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
    },
    siblings: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x3333333333333333333333333333333333333333333333333333333333333333',
    },
  });
});

test('Should not calc tree from 3 leaves with duplicate', () => {
  expect(() => {
    flexCalcTree({
      leaves: [
        '0x1111111111111111111111111111111111111111111111111111111111111111',
        '0x2222222222222222222222222222222222222222222222222222222222222222',
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      ],
    });
  }).toThrow(FlexError);
});

test('Should calc tree from 4 leaves', () => {
  const tree = flexCalcTree({
    leaves: [
      '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x4444444444444444444444444444444444444444444444444444444444444444',
    ],
  });
  expect(tree).toEqual({
    root: '0x037fd715441fd2ad3d0377ef74079ad743d29c09303ca301614df1ad14da48a7',
    parents: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0xc502f868a3f2d78c5adf18b41f606fc4c6cd8a4a9838125f03aadf235245b910',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0xc502f868a3f2d78c5adf18b41f606fc4c6cd8a4a9838125f03aadf235245b910',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x037fd715441fd2ad3d0377ef74079ad743d29c09303ca301614df1ad14da48a7',
      '0xc502f868a3f2d78c5adf18b41f606fc4c6cd8a4a9838125f03aadf235245b910':
        '0x037fd715441fd2ad3d0377ef74079ad743d29c09303ca301614df1ad14da48a7',
    },
    siblings: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x4444444444444444444444444444444444444444444444444444444444444444',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0xc502f868a3f2d78c5adf18b41f606fc4c6cd8a4a9838125f03aadf235245b910',
      '0xc502f868a3f2d78c5adf18b41f606fc4c6cd8a4a9838125f03aadf235245b910':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
    },
  });
});

test('Should calc tree from 5 leaves', () => {
  const tree = flexCalcTree({
    leaves: [
      '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x4444444444444444444444444444444444444444444444444444444444444444',
      '0x5555555555555555555555555555555555555555555555555555555555555555',
    ],
  });
  expect(tree).toEqual({
    root: '0x7fbfb091e5820c6665f1a680c8809d3da8f2e0e9becc8b7d5c7d182267b8063c',
    parents: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x5555555555555555555555555555555555555555555555555555555555555555':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe':
        '0x7fbfb091e5820c6665f1a680c8809d3da8f2e0e9becc8b7d5c7d182267b8063c',
      '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50':
        '0x7fbfb091e5820c6665f1a680c8809d3da8f2e0e9becc8b7d5c7d182267b8063c',
    },
    siblings: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0x5555555555555555555555555555555555555555555555555555555555555555',
      '0x5555555555555555555555555555555555555555555555555555555555555555':
        '0x4444444444444444444444444444444444444444444444444444444444444444',
      '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
    },
  });
});

test('Should calc tree from 11 leaves', () => {
  const tree = flexCalcTree({
    leaves: [
      '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x4444444444444444444444444444444444444444444444444444444444444444',
      '0x5555555555555555555555555555555555555555555555555555555555555555',
      '0x6666666666666666666666666666666666666666666666666666666666666666',
      '0x7777777777777777777777777777777777777777777777777777777777777777',
      '0x8888888888888888888888888888888888888888888888888888888888888888',
      '0x9999999999999999999999999999999999999999999999999999999999999999',
      '0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
      '0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',
    ],
  });
  expect(tree).toEqual({
    root: '0x907334f684e63958d6d40bbd48ac0e777a55a972f63d23b2c59dd9cb0741482d',
    parents: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x5555555555555555555555555555555555555555555555555555555555555555':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x6666666666666666666666666666666666666666666666666666666666666666':
        '0xecf521647d41100dda1ec1a80699e85f8e75ef6198272cc8d750b273caae5cd9',
      '0x7777777777777777777777777777777777777777777777777777777777777777':
        '0x2dc242daf280a11f41caad16109b7626a3865eb91064fded88387237f74cf7da',
      '0x8888888888888888888888888888888888888888888888888888888888888888':
        '0x2dc242daf280a11f41caad16109b7626a3865eb91064fded88387237f74cf7da',
      '0x9999999999999999999999999999999999999999999999999999999999999999':
        '0xa6b3c99304c811f01ce62b306c20ef0c701d864618ed3cadec4326225f4290c7',
      '0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa':
        '0x9f89faaf1495298300ca41edde79c5cc9cb9bf17e1c9ef97acfdc53194f901e1',
      '0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb':
        '0x9f89faaf1495298300ca41edde79c5cc9cb9bf17e1c9ef97acfdc53194f901e1',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe':
        '0x0305a02c1dbadae0747f5ba166d1a28cb83e50f67ed5d51abc25a9146fb76e90',
      '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50':
        '0xecf521647d41100dda1ec1a80699e85f8e75ef6198272cc8d750b273caae5cd9',
      '0xecf521647d41100dda1ec1a80699e85f8e75ef6198272cc8d750b273caae5cd9':
        '0x0305a02c1dbadae0747f5ba166d1a28cb83e50f67ed5d51abc25a9146fb76e90',
      '0x2dc242daf280a11f41caad16109b7626a3865eb91064fded88387237f74cf7da':
        '0xa6b3c99304c811f01ce62b306c20ef0c701d864618ed3cadec4326225f4290c7',
      '0xa6b3c99304c811f01ce62b306c20ef0c701d864618ed3cadec4326225f4290c7':
        '0xcdee7109b893471eee81b200bca23ee0470681b6560dfa8a32f11ae8c1c1b3cd',
      '0x9f89faaf1495298300ca41edde79c5cc9cb9bf17e1c9ef97acfdc53194f901e1':
        '0xcdee7109b893471eee81b200bca23ee0470681b6560dfa8a32f11ae8c1c1b3cd',
      '0x0305a02c1dbadae0747f5ba166d1a28cb83e50f67ed5d51abc25a9146fb76e90':
        '0x907334f684e63958d6d40bbd48ac0e777a55a972f63d23b2c59dd9cb0741482d',
      '0xcdee7109b893471eee81b200bca23ee0470681b6560dfa8a32f11ae8c1c1b3cd':
        '0x907334f684e63958d6d40bbd48ac0e777a55a972f63d23b2c59dd9cb0741482d',
    },
    siblings: {
      '0x1111111111111111111111111111111111111111111111111111111111111111':
        '0x2222222222222222222222222222222222222222222222222222222222222222',
      '0x2222222222222222222222222222222222222222222222222222222222222222':
        '0x1111111111111111111111111111111111111111111111111111111111111111',
      '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871':
        '0x3333333333333333333333333333333333333333333333333333333333333333',
      '0x3333333333333333333333333333333333333333333333333333333333333333':
        '0x3e92e0db88d6afea9edc4eedf62fffa4d92bcdfc310dccbe943747fe8302e871',
      '0x4444444444444444444444444444444444444444444444444444444444444444':
        '0x5555555555555555555555555555555555555555555555555555555555555555',
      '0x5555555555555555555555555555555555555555555555555555555555555555':
        '0x4444444444444444444444444444444444444444444444444444444444444444',
      '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50':
        '0x6666666666666666666666666666666666666666666666666666666666666666',
      '0x6666666666666666666666666666666666666666666666666666666666666666':
        '0x60c25b70d66af589f985b3cf4732585b8f7ecea5df88cb12368650edfe7e6f50',
      '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe':
        '0xecf521647d41100dda1ec1a80699e85f8e75ef6198272cc8d750b273caae5cd9',
      '0xecf521647d41100dda1ec1a80699e85f8e75ef6198272cc8d750b273caae5cd9':
        '0x87fbd8dad686d9536b2ef65757c3415df1b7a4664deb34eda3d91234936eb5fe',
      '0x7777777777777777777777777777777777777777777777777777777777777777':
        '0x8888888888888888888888888888888888888888888888888888888888888888',
      '0x8888888888888888888888888888888888888888888888888888888888888888':
        '0x7777777777777777777777777777777777777777777777777777777777777777',
      '0x2dc242daf280a11f41caad16109b7626a3865eb91064fded88387237f74cf7da':
        '0x9999999999999999999999999999999999999999999999999999999999999999',
      '0x9999999999999999999999999999999999999999999999999999999999999999':
        '0x2dc242daf280a11f41caad16109b7626a3865eb91064fded88387237f74cf7da',
      '0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa':
        '0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb',
      '0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb':
        '0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
      '0xa6b3c99304c811f01ce62b306c20ef0c701d864618ed3cadec4326225f4290c7':
        '0x9f89faaf1495298300ca41edde79c5cc9cb9bf17e1c9ef97acfdc53194f901e1',
      '0x9f89faaf1495298300ca41edde79c5cc9cb9bf17e1c9ef97acfdc53194f901e1':
        '0xa6b3c99304c811f01ce62b306c20ef0c701d864618ed3cadec4326225f4290c7',
      '0x0305a02c1dbadae0747f5ba166d1a28cb83e50f67ed5d51abc25a9146fb76e90':
        '0xcdee7109b893471eee81b200bca23ee0470681b6560dfa8a32f11ae8c1c1b3cd',
      '0xcdee7109b893471eee81b200bca23ee0470681b6560dfa8a32f11ae8c1c1b3cd':
        '0x0305a02c1dbadae0747f5ba166d1a28cb83e50f67ed5d51abc25a9146fb76e90',
    },
  });
});
